package it.academy.cv_storage.data.utilities;

import java.lang.reflect.Field;

import javax.persistence.Column;
import javax.persistence.Table;

import it.academy.cv_storage.exception.ClassHasNoCorrectAnnotation;
import it.academy.cv_storage.exception.StartSqlSentenceExeption;
import it.academy.cv_storage.model.entity.Candidate;

public class ClassInfoRetriever {

	private Class<?> className;

	public ClassInfoRetriever(Class<?> className) {
		this.className = className;
	}

	/*
	 * if class have @Annotation @Table with parameter = name of table in DB it will
	 * be returned table name else as default it will be returned class name
	 */
	public String getEntityTableName() throws ClassHasNoCorrectAnnotation {
		if (className.isAnnotationPresent(Table.class)) {
			if ((className.getAnnotation(Table.class)).name().length() == 0) {
				return className.getAnnotation(Table.class).name();

			} else {
				return className.getSimpleName().toLowerCase();
			}
		} else

			throw new ClassHasNoCorrectAnnotation("there is no annotation @Table in class: " + className.getName());
	}

	public String[] getSelectParameters(String... searchParam) throws NoSuchFieldException, SecurityException, StartSqlSentenceExeption {
		String[] result = null;
		
		if(className != null) {
			
			Field[] fields = className.getDeclaredFields();
			
			for (Field field : fields) {
				System.out.println("field name: " + field.getName());
				Column col = field.getAnnotation(Column.class);
				if (col != null) {
					System.out.println(">>>> @@@" + col.name());

					boolean isThereAnnot = col.name().toLowerCase().trim().equals("firSt_name".toLowerCase().trim());

					System.out.println(isThereAnnot);
					System.out.println("---------------------");
				}

				
			}
			return result;
		}
		throw new StartSqlSentenceExeption("You haven't insert class nafe to search from");


		
	}
}
