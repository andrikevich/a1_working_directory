<?xml version="1.0" encoding="UTF-8" ?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">


    <changeSet id="1" author="dmitry_an">
        <sql>
            CREATE DATABASE IF NOT EXISTS `cv_storage`
            CHARACTER SET utf8
            COLLATE utf8_general_ci;
        </sql>
    </changeSet>

    <changeSet id="2" author="dmitry_an">
        <sql>
            CREATE TABLE IF NOT EXISTS  `cv_storage`.`candidate` (
			  `ID` varchar(255) NOT NULL,
			  `BIRTH_DATE` date DEFAULT NULL,
			  `FIRST_NAME` varchar(255) DEFAULT NULL,
			  `GENDER` varchar(255) DEFAULT NULL,
			  `LAST_NAME` varchar(255) DEFAULT NULL,
			  `MIDDLE_NAME` varchar(255) DEFAULT NULL,
			  PRIMARY KEY (`id`)
			) ENGINE=InnoDB DEFAULT CHARSET=utf8;  
        </sql>
    </changeSet>

    <changeSet id="3" author="dmitry_an">
        <sql>
			CREATE TABLE IF NOT EXISTS  `cv_storage`. `email` (
			  `EMAIL_ID` varchar(255) NOT NULL,
			  `EMAIL_ADRESS` varchar(255) DEFAULT NULL,
			  `CANDIDATE_ID` varchar(255) DEFAULT NULL,
			  PRIMARY KEY (`EMAIL_ID`),
			  
			  CONSTRAINT `FK_EMAIL_CANDIDATE` FOREIGN KEY (`CANDIDATE_ID`) REFERENCES `candidate` (`ID`)
			  ON DELETE NO ACTION
			  ON UPDATE CASCADE
			  
			) ENGINE=InnoDB DEFAULT CHARSET=utf8;

        </sql>
    </changeSet>

    <changeSet id="4" author="dmitry_an">
        <sql>
            insert into ListExpenses.expenses (num, paydate, value, receiver) values
            (1, '2011-5-10',20000,1),
            (2, '2011-5-10',94200.0,2),
            (3, '2011-5-11',10000,3),
            (4, '2011-5-11',12950,2)
            ;
        </sql>
    </changeSet>

    <changeSet id="5" author="dmitry_an">
        <sql>
            ALTER TABLE `listexpenses`.`receivers` CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci;
        </sql>
    </changeSet>

    <changeSet id="6" author="dmitry_an">
        <sql>
            INSERT INTO `listexpenses`.`receivers` (`num`, `name`) VALUES
            (1, 'Интернет провайдер \"Соло\"'),
            (2,'Гипермаркет \"Корона\"'),
            (3,'МТС');
        </sql>
    </changeSet>

    <changeSet id="7" author="dmitry_an">
        <sql>
            ALTER TABLE `listexpenses`.`expenses`
            ADD CONSTRAINT `FK_RECEIVER`
            FOREIGN KEY (`receiver`)
            REFERENCES `listexpenses`.`receivers` (`num`);
        </sql>
    </changeSet>


</databaseChangeLog>